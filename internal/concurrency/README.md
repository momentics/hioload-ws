# –°–ª–æ–π –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ—Å—Ç–∏ –∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

–î–∞–Ω–Ω—ã–π –º–æ–¥—É–ª—å —Ä–µ–∞–ª–∏–∑—É–µ—Ç –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º—É—é —Å–∏—Å—Ç–µ–º—É –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ—Å—Ç–∏, —Å–æ–±—ã—Ç–∏–π–Ω—ã–π —Ü–∏–∫–ª –Ω–∞ –æ—Å–Ω–æ–≤–µ poll-–º–æ–¥–µ–ª–∏ (reactor pattern), –∞ —Ç–∞–∫–∂–µ –≤—ã—Å–æ–∫–æ—Ç–æ—á–Ω—ã–π –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ (scheduler), –∫–æ—Ç–æ—Ä—ã–µ —Å–æ—Å—Ç–∞–≤–ª—è—é—Ç –æ—Å–Ω–æ–≤—É –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã hioload-ws.

–í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–ª–æ—è:
- –ø–æ–ª–Ω–æ—Å—Ç—å—é –∫—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω—ã–µ (–ø–æ–¥–¥–µ—Ä–∂–∫–∞ Linux –∏ Windows);
- –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã –Ω–∞ —Ä–∞–±–æ—Ç—É –≤ —É—Å–ª–æ–≤–∏—è—Ö —Å–≤–µ—Ä—Ö –≤—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ (high-load);
- –ø–æ—Å—Ç—Ä–æ–µ–Ω—ã —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —à–∞–±–ª–æ–Ω–æ–≤ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã **zero-copy**, **NUMA-aware**, **lock-free**;
- –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É—é—Ç—Å—è —Å –æ—Å—Ç–∞–ª—å–Ω—ã–º–∏ —Å–ª–æ—è–º–∏ —Å–∏—Å—Ç–µ–º—ã, –≤–∫–ª—é—á–∞—è `/api`, `/pool`, `/internal/transport`, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è clean-architecture-–ø–æ–¥—Ö–æ–¥.

## –í–∫–ª—é—á—ë–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

### Event Loop (`eventloop.go`)
- –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–µ–±–ª–æ–∫–∏—Ä—É—é—â–µ–≥–æ —Å–æ–±—ã—Ç–∏–π–Ω–æ–≥–æ —Ü–∏–∫–ª–∞.
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –º–∞—Å—Å–∏–≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ (`EventHandler`) —Å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–µ–π/—É–¥–∞–ª–µ–Ω–∏–µ–º –≤–æ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã (thread-safe).
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `RingBuffer` –∏–∑ `/pool` –¥–ª—è –æ—á–µ—Ä–µ–¥–µ–π —Å–æ–±—ã—Ç–∏–π –±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫.
- –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø–∞–∫–µ—Ç–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É (`batching`) —Å–æ–±—ã—Ç–∏–π –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ–ø—É—Å–∫–Ω–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –ø—Ä–∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–µ.

### –ü–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω—ã–µ poller‚Äô—ã
- **Linux**: `poller_linux.go` ‚Äî —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –Ω–∞ –æ—Å–Ω–æ–≤–µ `epoll`, —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –∑–∞–º–µ–Ω—ã –Ω–∞ `io_uring` –≤ –±—É–¥—É—â–µ–º.
- **Windows**: `poller_windows.go` ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `IOCP` (I/O Completion Ports) –¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ–π –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ–π –Ω–µ–±–ª–æ–∫–∏—Ä—É—é—â–µ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ I/O.

–û–±–∞ poller-–∞ —Ä–µ–∞–ª–∏–∑—É—é—Ç:
- NUMA-aware —Ä–∞–±–æ—Ç—É (—Ä–∞—Å–ø–∞—Ä–∞–ª–ª–µ–ª–µ–Ω–æ –ø–æ –∫–æ–ª—å—Ü–µ–≤—ã–º –±—É—Ñ–µ—Ä–∞–º –ª–æ–∫–∞–ª—å–Ω–æ –∫ NUMA-–ø–∞–º—è—Ç–∏);
- –∑–∞–¥–µ—Ä–∂–∫—É –æ–∂–∏–¥–∞–Ω–∏—è —Å–æ–±—ã—Ç–∏–π –Ω–∞ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–Ω–æ–º —É—Ä–æ–≤–Ω–µ;
- –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏/—É–¥–∞–ª–µ–Ω–∏—è –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–æ–≤;
- –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å —Ç–æ–ø–æ–ª–æ–≥–∏–µ–π ring buffer + –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –∏–∑ —Å–ª–æ—è event loop.

### ü™´ Scheduler (`scheduler.go`)
- –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ —Å–≤–µ—Ä—Ö–≤—ã—Å–æ–∫–æ—Ç–æ—á–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–∏;
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è: –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç–∞–π–º–∞—É—Ç–æ–≤, —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ idle-–∫–æ–Ω—Ç—Ä–æ–ª—è, ping/pong —Ç–∞–π–º–µ—Ä–æ–≤ –≤ WebSocket;
- –û—Å–Ω–æ–≤–∞–Ω –Ω–∞ `Cancelable` –∏–∑ API ‚Äî –≤—Å–µ –∑–∞–¥–∞—á–∏ –º–æ–∂–Ω–æ –æ—Ç–º–µ–Ω–∏—Ç—å –ø–æ –º–µ—Ä–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏;
- –†–∞–±–æ—Ç–∞–µ—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –û–° ‚Äî –∫—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω—ã–π.

### ThreadPool & Executor
- NUMA-aware thread –ø—É–ª;
- –ü–æ–∑–≤–æ–ª—è–µ—Ç –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ—Ä–∫–µ—Ä–æ–≤ –Ω–∞ —Ä–∞–Ω—Ç–∞–π–º–µ (`Resize`);
- –ò–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è —Å CPU pinning –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –ª–æ–∫–∞–ª—å–Ω–æ—Å—Ç–∏;
- –†–∞–±–æ—Ç–∞–µ—Ç —Å–æ–≤–º–µ—Å—Ç–Ω–æ —Å event loop, poller –∏ scheduler.

### CPU pinning –∏ NUMA-affinity (`pin_*.go`)
- –î–ª—è Linux –∏ Windows —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –≤ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º:
  - `sched_setaffinity`/`pthread` (Linux),
  - `SetThreadAffinityMask` (Windows).
- –£–ø—Ä–∞–≤–ª—è—é—Ç –ø—Ä–∏–≤—è–∑–∫–æ–π —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤ (OS thread) –∫ –∑–∞–¥–∞–Ω–Ω–æ–º—É CPU/NUMA.

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ
- –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –∏–∑ `/api` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `Poller`, `Handler`, `Scheduler`).
- –ö–æ–ª—å—Ü–µ–≤—ã–µ –±—É—Ñ–µ—Ä—ã (`RingBuffer`) –∏–∑ `/pool` –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ event loop –∏ –≤ poller –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –ø–µ—Ä–µ–¥–∞—á–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –º–µ–∂–¥—É –ø–æ—Ç–æ–∫–∞–º–∏.
- –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ª–∏–±–æ lock-free, –ª–∏–±–æ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏.

### –¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å –∏ —Ä–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å
- –ö–∞–∂–¥–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–µ–º–∞ –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–∞.
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–æ–∫–∞-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ –≤—Å—Ç—Ä–æ–µ–Ω–∞ –≤ –æ—Å–Ω–æ–≤–Ω–æ–π API —Å–ª–æ–π (`api/testing.go`).
- –ü—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –µ–¥–∏–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º –æ—Å—Ç–∞–Ω–æ–≤–∫–∏, –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤–æ—Ä–∫–µ—Ä–æ–≤ –∏ –∑–∞–¥–∞—á (—á–µ—Ä–µ–∑ `Cancelable`, `Stop()` –∏ –∫–∞–Ω–∞–ª—ã –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è).

---

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Å–ª–æ—è

–ö–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω—ã–π –∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–π —Å–ª–æ–π (Concurrency & Scheduling Layer) ‚Äî —ç—Ç–æ —Å–∏—Å—Ç–µ–º–Ω–æ–µ —è–¥—Ä–æ –≤—Å–µ–π —Ä–∞–±–æ—Ç—ã —Å —Å–æ–±—ã—Ç–∏—è–º–∏, –æ–±—Ä–∞–±–æ—Ç–∫–æ–π —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π, –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω—ã–º–∏ –∑–∞–¥–∞—á–∞–º–∏ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π —Ç–∞–π–º–∞—É—Ç–æ–≤ –≤ hioload-ws.

–û–Ω –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:
- —Å—Ç–∞–±–∏–ª—å–Ω—É—é –∏ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—É—é –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å –ø–æ–¥ –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å;
- NUMA-aware –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω—ã–π event loop;
- –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é –∑–∞–¥–µ—Ä–∂–∫—É —Ä–µ–∞–∫—Ü–∏–∏ –Ω–∞ I/O (—á–µ—Ä–µ–∑ EPOLL/IOCP);
- –ø–ª–∞–≤–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É —Ç—ã—Å—è—á —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –∏ –ø–∞–∫–µ—Ç–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É.

---

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

- –í—ã–¥–µ–ª—è–π—Ç–µ `EventLoop` –Ω–∞ –∫–∞–∂–¥—ã–π CPU/NUMA —É–∑–µ–ª –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Å–∏—Å—Ç–µ–º—ã;
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `Scheduler` –¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö —Ç–∞–π–º–µ—Ä–æ–≤ –∏ –∫–æ–Ω—Ç—Ä–æ–ª—è –±–µ–∑ –ª–∏—à–Ω–µ–≥–æ —Ä–∞—Å—Ö–æ–¥–∞ CPU;
- –û–±—ä–µ–¥–∏–Ω—è–π—Ç–µ `Poller + RingBuffer + EventLoop` –∫–∞–∫ –±–∞–∑–æ–≤—ã–π react-loop;
- –í –ø—Ä–æ–¥–∞–∫—à–Ω –æ–∫—Ä—É–∂–µ–Ω–∏—è—Ö –≤–∫–ª—é—á–∏—Ç–µ CPU affinity –∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –≤–æ—Ä–∫–µ—Ä—ã –ø–æ —Ç–æ–ø–æ–ª–æ–≥–∏–∏ –≤–∞—à–µ–π NUMA.

---

–í—Å–µ —Ñ–∞–π–ª—ã —Å–æ–¥–µ—Ä–∂–∞—Ç –ø–æ–ª–Ω–æ—Ñ–æ—Ä–º–∞—Ç–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º —è–∑—ã–∫–µ –∏ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω—ã –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –≤—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã—Ö, –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º—ã—Ö —Å–µ—Ç–µ–≤—ã—Ö —Å–µ—Ä–≤–∏—Å–∞—Ö —Å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –ª–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å—é –∏ –≤—ã—Å–æ–∫–æ–π —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å—é.
